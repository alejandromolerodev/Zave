<div class="container py-4">
  <h1 class="mb-4">
    Bienvenido a Zave 游녦, {{ usuarioNombre || "Cargando..." }}
  </h1>
  <p>Este es tu panel principal de resumen financiero.</p>

  <!-- Selector de Cuenta -->
  <div class="card mb-4 p-3 shadow-sm">
    <h2 class="h5 mb-3">Selecciona una Cuenta</h2>
    <select
      [(ngModel)]="selectedCuenta"
      (ngModelChange)="onCuentaSeleccionada($event)"
      class="form-select mb-3"
      aria-label="Seleccionar Cuenta"
    >
      <option *ngFor="let cuenta of cuentas" [ngValue]="cuenta">
        {{ cuenta.nombre }}
      </option>
    </select>
    <button (click)="irACrearCuenta()" class="btn btn-info">
      Crear Nueva Cuenta
    </button>
  </div>

  <!-- Resumen Mensual -->
  <div class="card mb-4 p-3 shadow-sm">
    <h2 class="h5 mb-3">
      Resumen Financiero de {{ usuarioNombre || "Cargando..." }}
    </h2>
    <ul class="list-unstyled mb-0">
      <li>
        <strong>Cuenta Seleccionada:</strong>
        {{ selectedCuenta?.nombre || "Ninguna seleccionada" }}
      </li>
      <li>
        <strong>Saldo:</strong> ${{
          selectedCuenta?.saldo?.toFixed(2) || "0.00"
        }}
      </li>
      <li>
        <strong>Ingresos Totales:</strong> ${{ ingresosTotales.toFixed(2) }}
      </li>
      <li><strong>Gastos Totales:</strong> ${{ gastosTotales.toFixed(2) }}</li>
      <li><strong>Ahorro Mensual:</strong> ${{ ahorroMensual.toFixed(2) }}</li>
      <li>
        <strong>Porcentaje de Ahorro:</strong>
        {{ porcentajeAhorro.toFixed(2) }}%
      </li>
    </ul>

    <div *ngIf="alertas.length > 0" class="alert alert-warning mt-3 p-2">
      <h3 class="h6 mb-2">Alertas:</h3>
      <ul class="mb-0">
        <li *ngFor="let alerta of alertas">{{ alerta }}</li>
      </ul>
    </div>
  </div>

  <!-- Gr치fico -->
  <div class="card mb-4 p-3 shadow-sm">
    <h2 class="h5 mb-3">Gr치fico Resumen</h2>
    <button (click)="cambiarTipoGrafica()" class="btn btn-primary mb-3">
      Cambiar Tipo de Gr치fica
    </button>
    <div class="grafica-container">
      <canvas id="graficaResumen"></canvas>
    </div>
  </div>

  <!-- Formulario Ingreso -->
  <div *ngIf="mostrarFormularioIngreso" class="card p-3 mb-4 shadow-sm">
    <h3 class="h6 mb-3">Agregar Ingreso</h3>
    <form (ngSubmit)="agregarIngreso()" class="row g-3">
      <div class="col-md-3">
        <label for="ingresoImporte" class="form-label">Importe</label>
        <input
          id="ingresoImporte"
          type="number"
          [(ngModel)]="nuevoIngreso"
          name="nuevoIngreso"
          class="form-control"
          placeholder="0.00"
          required
          min="0"
          step="0.01"
        />
      </div>

      <div class="col-md-3">
        <label for="ingresoCategoria" class="form-label">Categor칤a</label>
        <input
          id="ingresoCategoria"
          type="text"
          [(ngModel)]="ingresoCategoria"
          name="ingresoCategoria"
          class="form-control"
          placeholder="Categor칤a"
          required
        />
      </div>

      <div class="col-md-4">
        <label for="ingresoDescripcion" class="form-label">Descripci칩n</label>
        <input
          id="ingresoDescripcion"
          type="text"
          [(ngModel)]="ingresoDescripcion"
          name="ingresoDescripcion"
          class="form-control"
          placeholder="Descripci칩n"
        />
      </div>

      <div class="col-md-2">
        <label for="ingresoFecha" class="form-label">Fecha</label>
        <input
          id="ingresoFecha"
          type="date"
          [(ngModel)]="ingresoFecha"
          name="ingresoFecha"
          class="form-control"
          required
        />
      </div>

      <div class="col-12">
        <button type="submit" class="btn btn-success">Agregar Ingreso</button>
      </div>
    </form>
  </div>

  <!-- Formulario Gasto -->
  <div *ngIf="mostrarFormularioGasto" class="card p-3 mb-4 shadow-sm">
    <h3 class="h6 mb-3">Agregar Gasto</h3>
    <form (ngSubmit)="agregarGasto()" class="row g-3">
      <div class="col-md-3">
        <label for="gastoImporte" class="form-label">Importe</label>
        <input
          id="gastoImporte"
          type="number"
          [(ngModel)]="nuevoGasto"
          name="nuevoGasto"
          class="form-control"
          placeholder="0.00"
          required
          min="0"
          step="0.01"
        />
      </div>

      <div class="col-md-3">
        <label for="gastoCategoria" class="form-label">Categor칤a</label>
        <input
          id="gastoCategoria"
          type="text"
          [(ngModel)]="gastoCategoria"
          name="gastoCategoria"
          class="form-control"
          placeholder="Categor칤a"
          required
        />
      </div>

      <div class="col-md-4">
        <label for="gastoDescripcion" class="form-label">Descripci칩n</label>
        <input
          id="gastoDescripcion"
          type="text"
          [(ngModel)]="gastoDescripcion"
          name="gastoDescripcion"
          class="form-control"
          placeholder="Descripci칩n"
        />
      </div>

      <div class="col-md-2">
        <label for="gastoFecha" class="form-label">Fecha</label>
        <input
          id="gastoFecha"
          type="date"
          [(ngModel)]="gastoFecha"
          name="gastoFecha"
          class="form-control"
          required
        />
      </div>

      <div class="col-12">
        <button type="submit" class="btn btn-warning">Agregar Gasto</button>
      </div>
    </form>
  </div>

  <!-- Botones para mostrar formularios -->
  <div class="card p-3 shadow-sm">
    <button (click)="toggleFormularioIngreso()" class="btn btn-success me-2">
      Agregar Ingreso
    </button>
    <button (click)="toggleFormularioGasto()" class="btn btn-warning">
      Agregar Gasto
    </button>
  </div>
</div>
